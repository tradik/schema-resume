<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NG0TH0GXV1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NG0TH0GXV1');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Convert and validate JSON Resume to JSON-LD or XML format in real-time. Supports remote and local schema contexts.">
    <meta name="keywords" content="JSON to JSON-LD converter, JSON to XML, Resume converter, CV converter, JSON-LD, Schema.org">
    <meta name="author" content="Tradik">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://schema-resume.org/converter.html">
    <link rel="alternate" href="https://tradik.github.io/schema-resume/converter.html">
    <meta name="theme-color" content="#2563eb">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://schema-resume.org/converter.html">
    <meta property="og:title" content="Schema Resume Converter - JSON Resume to JSON-LD & XML">
    <meta property="og:description" content="Convert JSON Resume to JSON-LD or XML format in real-time. Supports remote and local schema contexts with instant validation.">
    <meta property="og:image" content="https://schema-resume.org/og-image.png">
    <meta property="og:site_name" content="Schema Resume">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://schema-resume.org/converter.html">
    <meta property="twitter:title" content="Schema Resume Converter - JSON Resume to JSON-LD & XML">
    <meta property="twitter:description" content="Convert JSON Resume to JSON-LD or XML format in real-time. Supports remote and local schema contexts with instant validation.">
    <meta property="twitter:image" content="https://schema-resume.org/og-image.png">
    
    <title>JSON Resume Converter - Schema Resume</title>
    
    <script src="https://cdn.jsdelivr.net/npm/ajv@6.12.6/dist/ajv.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#990000',
                        secondary: '#7a0000',
                        accent: '#facc2e',
                    },
                    fontFamily: {
                        sans: ['Verdana', 'Geneva', 'DejaVu Sans', 'sans-serif'],
                        mono: ['monospace'],
                    },
                    borderRadius: {
                        'freebsd': '10px',
                    }
                }
            }
        }
    </script>
    
    <style>
        :root {
            --primary-color: #990000;
            --secondary-color: #7a0000;
            --accent-color: #facc2e;
            --text-primary: #000000;
            --text-secondary: #666666;
            --text-tertiary: #737373;
            --bg-primary: #ffffff;
            --bg-secondary: #eeeeee;
            --border-color: #cccccc;
            --border-light: #dadada;
            --success-color: #10b981;
            --error-color: #9f1313;
            --warning-color: #f59e0b;
            --code-bg: #eeddcc;
        }
        
        body {
            font-family: Verdana, Geneva, 'DejaVu Sans', sans-serif;
            background-color: var(--bg-primary);
            margin: 0;
            padding: 0;
            line-height: 1.2;
        }
        
        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: calc(100vh - 300px);
            min-height: 500px;
        }
        
        .editor-panel {
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .editor-header {
            background-color: var(--primary-color);
            color: white;
            padding: 16px 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .editor-header h3 {
            margin: 0;
            font-size: 110%;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }
        
        .editor-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        textarea {
            width: 100%;
            height: 100%;
            border: none;
            padding: 20px;
            font-family: monospace;
            font-size: 1.1em;
            line-height: 1.2;
            resize: none;
            background-color: var(--code-bg);
            color: var(--text-primary);
        }
        
        textarea:focus {
            outline: none;
            background-color: #ffffff;
        }
        
        .status-bar {
            padding: 8px 20px;
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--text-secondary);
        }
        
        .status-dot.success {
            background-color: var(--success-color);
        }
        
        .status-dot.error {
            background-color: var(--error-color);
        }
        
        .status-dot.warning {
            background-color: var(--warning-color);
        }
        
        .error-message {
            background-color: #fee;
            border-left: 4px solid var(--error-color);
            padding: 12px 16px;
            margin: 10px 20px;
            border-radius: 4px;
            font-size: 13px;
            color: #c00;
        }
        
        .warning-message {
            background-color: #fffbeb;
            border-left: 4px solid var(--warning-color);
            padding: 12px 16px;
            margin: 10px 20px;
            border-radius: 4px;
            font-size: 13px;
            color: #92400e;
        }
        
        .success-message {
            background-color: #f0fdf4;
            border-left: 4px solid var(--success-color);
            padding: 12px 16px;
            margin: 10px 20px;
            border-radius: 4px;
            font-size: 13px;
            color: #166534;
        }
        
        @media (max-width: 1024px) {
            .editor-container {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .editor-panel {
                min-height: 400px;
            }
        }
        
        .status-bar .status-item:last-child {
            border-right: none;
        }
        
        header a:hover {
            background-color: rgba(255, 255, 255, 0.2) !important;
        }
        
        footer a:hover {
            text-decoration: underline !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header style="background-color: #990000; color: white; padding: 20px 0; border-bottom: 3px solid #7a0000;">
        <div class="max-w-7xl mx-auto px-4">
            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 15px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span role="img" aria-label="Document" style="font-size: 32px;">📄</span>
                    <h1 style="margin: 0; font-size: 140%; font-family: Verdana, Geneva, 'DejaVu Sans', sans-serif; font-weight: bold;">Schema Resume</h1>
                </div>
                <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                    <a href="./index.html" style="color: white; text-decoration: none; font-size: 90%; padding: 6px 12px; border-radius: 4px; transition: background-color 0.2s;">Home</a>
                    <a href="./validator.html" style="color: white; text-decoration: none; font-size: 90%; padding: 6px 12px; border-radius: 4px; transition: background-color 0.2s;">Validator</a>
                    <a href="./converter.html" style="color: white; text-decoration: none; font-size: 90%; padding: 6px 12px; border-radius: 4px; background-color: rgba(255, 255, 255, 0.2);">Converter</a>
                    <a href="https://github.com/tradik/schema-resume" style="color: white; text-decoration: none; font-size: 90%; padding: 6px 12px; border-radius: 4px; transition: background-color 0.2s;">GitHub</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Page Title -->
    <div style="background-color: #eeeeee; border-bottom: 1px solid #cccccc; padding: 20px 0;">
        <div class="max-w-7xl mx-auto px-4">
            <h2 style="margin: 0; font-size: 140%; color: #000000; font-family: Verdana, Geneva, 'DejaVu Sans', sans-serif; font-weight: bold;">Converter</h2>
            <p style="margin: 5px 0 0 0; color: #666666; font-size: 95%; font-family: Verdana, Geneva, 'DejaVu Sans', sans-serif;">Real-time conversion to JSON-LD and XML with validation</p>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Controls -->
        <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- Output Format -->
                <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-2">
                        <i data-lucide="file-type" size="16" class="inline"></i>
                        Output Format
                    </label>
                    <select id="outputFormat" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="jsonld">JSON-LD</option>
                        <option value="xml">XML</option>
                    </select>
                </div>
                
                <!-- Context Type -->
                <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-2">
                        <i data-lucide="link" size="16" class="inline"></i>
                        <span id="contextTypeLabel">Context Type</span>
                    </label>
                    <select id="contextType" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="remote">Remote Schema (URL)</option>
                        <option value="inline" id="inlineOption">Inline Context</option>
                    </select>
                </div>
                
                <!-- Actions -->
                <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-2">
                        <i data-lucide="settings" size="16" class="inline"></i>
                        Actions
                    </label>
                    <div class="flex gap-2">
                        <button id="loadExample" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <i data-lucide="file-text" size="16"></i>
                            Load Example
                        </button>
                        <button id="clearBtn" class="bg-slate-200 hover:bg-slate-300 text-slate-700 px-4 py-2 rounded-lg transition-colors">
                            <i data-lucide="x" size="16"></i>
                        </button>
                        <button id="copyOutput" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                            <i data-lucide="copy" size="16"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Editor Panels -->
        <div class="editor-container">
            <!-- Input Panel -->
            <div class="editor-panel">
                <div class="editor-header">
                    <h3>
                        <i data-lucide="edit-3" size="20"></i>
                        Input JSON
                    </h3>
                    <span id="inputChars" class="text-sm opacity-80">0 chars</span>
                </div>
                <div class="editor-content">
                    <textarea id="inputJson" placeholder="Paste your JSON resume here..."></textarea>
                </div>
                <div class="status-bar">
                    <div class="status-indicator">
                        <div id="inputStatus" class="status-dot"></div>
                        <span id="inputStatusText">Ready</span>
                    </div>
                    <span id="inputLines">0 lines</span>
                </div>
            </div>

            <!-- Output Panel -->
            <div class="editor-panel">
                <div class="editor-header">
                    <h3>
                        <i data-lucide="file-output" size="20"></i>
                        Output <span id="outputFormatLabel">(JSON-LD)</span>
                    </h3>
                    <span id="outputChars" class="text-sm opacity-80">0 chars</span>
                </div>
                <div class="editor-content">
                    <textarea id="outputJson" readonly placeholder="Converted output will appear here..."></textarea>
                </div>
                <div class="status-bar">
                    <div class="status-indicator">
                        <div id="outputStatus" class="status-dot"></div>
                        <span id="outputStatusText">Waiting for input</span>
                    </div>
                    <span id="outputLines">0 lines</span>
                </div>
            </div>
        </div>

        <!-- Messages -->
        <div id="messages" class="mt-4"></div>

        <!-- Info Section -->
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-slate-900 mb-3 flex items-center gap-2">
                <i data-lucide="info" size="20"></i>
                How to Use
            </h3>
            <ul class="space-y-2 text-sm text-slate-700">
                <li class="flex items-start gap-2">
                    <i data-lucide="check" size="16" class="text-blue-600 flex-shrink-0 mt-0.5"></i>
                    <span><strong>Paste or type</strong> your JSON resume in the left panel</span>
                </li>
                <li class="flex items-start gap-2">
                    <i data-lucide="check" size="16" class="text-blue-600 flex-shrink-0 mt-0.5"></i>
                    <span><strong>Select output format</strong>: JSON-LD (with Schema.org context) or XML</span>
                </li>
                <li class="flex items-start gap-2">
                    <i data-lucide="check" size="16" class="text-blue-600 flex-shrink-0 mt-0.5"></i>
                    <span><strong>Choose context type</strong>: Remote (URL reference) or Inline (embedded context)</span>
                </li>
                <li class="flex items-start gap-2">
                    <i data-lucide="check" size="16" class="text-blue-600 flex-shrink-0 mt-0.5"></i>
                    <span><strong>Real-time conversion</strong>: Output updates automatically as you type</span>
                </li>
                <li class="flex items-start gap-2">
                    <i data-lucide="check" size="16" class="text-blue-600 flex-shrink-0 mt-0.5"></i>
                    <span><strong>Validation</strong>: Errors and warnings are displayed instantly</span>
                </li>
            </ul>
        </div>
    </main>

    <!-- Footer -->
    <footer style="text-align: center; padding: 40px 20px; color: #737373; border-top: 1px solid #cccccc; margin-top: 40px; font-size: 0.9em; line-height: 1.3em; font-family: Verdana, Geneva, 'DejaVu Sans', sans-serif;">
        <div class="max-w-7xl mx-auto px-4">
            <p>&copy; 2025 Schema Resume. Released under the MIT License.</p>
            <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px; flex-wrap: wrap;">
                <a href="https://github.com/tradik/schema-resume" style="color: #990000; text-decoration: none;">GitHub</a>
                <a href="https://github.com/tradik/schema-resume/issues" style="color: #990000; text-decoration: none;">Issues</a>
                <a href="https://github.com/tradik/schema-resume/blob/main/LICENSE" style="color: #990000; text-decoration: none;">License</a>
                <a href="./validator.html" style="color: #990000; text-decoration: none;">Validator</a>
                <a href="./converter.html" style="color: #990000; text-decoration: none;">Converter</a>
            </div>
            <p style="margin-top: 20px; font-size: 0.9rem;">Made with <span role="img" aria-label="love">❤️</span> for the developer community</p>
        </div>
    </footer>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Elements
        const inputJson = document.getElementById('inputJson');
        const outputJson = document.getElementById('outputJson');
        const outputFormat = document.getElementById('outputFormat');
        const contextType = document.getElementById('contextType');
        const loadExampleBtn = document.getElementById('loadExample');
        const clearBtn = document.getElementById('clearBtn');
        const copyOutputBtn = document.getElementById('copyOutput');
        const messagesDiv = document.getElementById('messages');
        const outputFormatLabel = document.getElementById('outputFormatLabel');

        // Status elements
        const inputStatus = document.getElementById('inputStatus');
        const inputStatusText = document.getElementById('inputStatusText');
        const outputStatus = document.getElementById('outputStatus');
        const outputStatusText = document.getElementById('outputStatusText');
        const inputChars = document.getElementById('inputChars');
        const outputChars = document.getElementById('outputChars');
        const inputLines = document.getElementById('inputLines');
        const outputLines = document.getElementById('outputLines');

        // Schema and context
        let schema = null;
        let context = null;
        let ajv = null;

        // Load schema and context
        async function loadSchema() {
            try {
                const [schemaRes, contextRes] = await Promise.all([
                    fetch('./schema.json'),
                    fetch('./context.jsonld')
                ]);
                
                schema = await schemaRes.json();
                context = await contextRes.json();
                
                // Initialize AJV
                const Ajv = window.ajv2020 || window.Ajv2020 || window.Ajv;
                if (!Ajv) {
                    throw new Error('AJV library not loaded');
                }
                ajv = new Ajv({
                    allErrors: true,
                    verbose: true,
                    strict: false
                });
                
                // Add formats if available
                if (window.ajvFormats) {
                    window.ajvFormats(ajv);
                }
                
                console.log('Schema and context loaded successfully');
            } catch (error) {
                showMessage('error', `Failed to load schema: ${error.message}`);
            }
        }

        // Convert JSON to JSON-LD
        function convertToJsonLd(data, useInlineContext) {
            const output = { ...data };
            
            if (useInlineContext && context) {
                // Inline context
                output['@context'] = context['@context'];
            } else {
                // Remote context
                output['@context'] = 'https://tradik.github.io/schema-resume/context.jsonld';
            }
            
            // Ensure $schema is present
            if (!output.$schema) {
                output.$schema = 'https://tradik.github.io/schema-resume/schema.json';
            }
            
            return output;
        }

        // Convert JSON to XML
        function convertToXml(data, useInlineContext, indent = 0) {
            const indentStr = '  '.repeat(indent);
            let xml = '';
            
            if (indent === 0) {
                xml += '<?xml version="1.0" encoding="UTF-8"?>\n';
                if (useInlineContext) {
                    // Inline schema location (no remote reference)
                    xml += '<resume xmlns="https://tradik.github.io/schema-resume/xml/1.0"\n';
                    xml += '        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n';
                } else {
                    // Remote schema location reference
                    xml += '<resume xmlns="https://tradik.github.io/schema-resume/xml/1.0"\n';
                    xml += '        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n';
                    xml += '        xsi:schemaLocation="https://tradik.github.io/schema-resume/xml/1.0\n';
                    xml += '                            https://tradik.github.io/schema-resume/xml/1.0/schema-resume.xsd">\n';
                }
            }
            
            for (const [key, value] of Object.entries(data)) {
                if (key.startsWith('@') || key.startsWith('$')) continue;
                
                if (value === null || value === undefined) {
                    continue;
                } else if (Array.isArray(value)) {
                    // Handle arrays - for XSD compatibility, wrap items in container
                    if (value.length > 0 && typeof value[0] === 'object') {
                        // Array of objects - each object becomes an element
                        value.forEach(item => {
                            xml += `${indentStr}  <${key}>\n`;
                            xml += convertToXml(item, useInlineContext, indent + 2);
                            xml += `${indentStr}  </${key}>\n`;
                        });
                    } else if (value.length > 0) {
                        // Array of primitives - wrap in parent element with <item> children
                        xml += `${indentStr}  <${key}>\n`;
                        value.forEach(item => {
                            xml += `${indentStr}    <item>${escapeXml(String(item))}</item>\n`;
                        });
                        xml += `${indentStr}  </${key}>\n`;
                    }
                } else if (typeof value === 'object') {
                    xml += `${indentStr}  <${key}>\n`;
                    xml += convertToXml(value, useInlineContext, indent + 2);
                    xml += `${indentStr}  </${key}>\n`;
                } else {
                    xml += `${indentStr}  <${key}>${escapeXml(String(value))}</${key}>\n`;
                }
            }
            
            if (indent === 0) {
                xml += '</resume>';
            }
            
            return xml;
        }

        // Escape XML special characters
        function escapeXml(str) {
            return str
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&apos;');
        }

        // Validate JSON
        function validateJson(data) {
            if (!ajv || !schema) {
                return { valid: false, errors: ['Schema not loaded'] };
            }
            
            // Create a copy without @context for validation (JSON-LD specific, not in schema)
            const dataForValidation = { ...data };
            delete dataForValidation['@context'];
            
            // Create a copy of schema without $schema reference to avoid meta-schema resolution
            const schemaForValidation = { ...schema };
            delete schemaForValidation['$schema'];
            delete schemaForValidation['@context'];
            
            const validate = ajv.compile(schemaForValidation);
            const valid = validate(dataForValidation);
            
            return {
                valid,
                errors: validate.errors || []
            };
        }

        // Process input
        function processInput() {
            const input = inputJson.value.trim();
            
            // Update stats
            updateStats(input, 'input');
            
            if (!input) {
                clearOutput();
                setStatus('input', 'ready', 'Ready');
                setStatus('output', 'ready', 'Waiting for input');
                clearMessages();
                return;
            }
            
            try {
                // Parse JSON
                const data = JSON.parse(input);
                setStatus('input', 'success', 'Valid JSON');
                
                // Validate against schema
                const validation = validateJson(data);
                
                if (!validation.valid) {
                    const errorCount = validation.errors.length;
                    showMessage('warning', `JSON is valid but has ${errorCount} schema validation error${errorCount !== 1 ? 's' : ''}`);
                    setStatus('input', 'warning', `${errorCount} validation error${errorCount !== 1 ? 's' : ''}`);
                } else {
                    showMessage('success', 'JSON is valid and matches schema');
                }
                
                // Convert based on selected format
                const format = outputFormat.value;
                const useInlineContext = contextType.value === 'inline';
                
                let output;
                if (format === 'jsonld') {
                    output = convertToJsonLd(data, useInlineContext);
                    output = JSON.stringify(output, null, 2);
                    setStatus('output', 'success', 'JSON-LD generated');
                } else if (format === 'xml') {
                    output = convertToXml(data, useInlineContext);
                    setStatus('output', 'success', 'XML generated');
                }
                
                outputJson.value = output;
                updateStats(output, 'output');
                
            } catch (error) {
                setStatus('input', 'error', 'Invalid JSON');
                showMessage('error', `JSON Parse Error: ${error.message}`);
                clearOutput();
            }
        }

        // Update statistics
        function updateStats(text, type) {
            const chars = text.length;
            const lines = text ? text.split('\n').length : 0;
            
            if (type === 'input') {
                inputChars.textContent = `${chars.toLocaleString()} chars`;
                inputLines.textContent = `${lines} lines`;
            } else {
                outputChars.textContent = `${chars.toLocaleString()} chars`;
                outputLines.textContent = `${lines} lines`;
            }
        }

        // Set status
        function setStatus(panel, type, text) {
            const statusDot = panel === 'input' ? inputStatus : outputStatus;
            const statusText = panel === 'input' ? inputStatusText : outputStatusText;
            
            statusDot.className = 'status-dot';
            if (type !== 'ready') {
                statusDot.classList.add(type);
            }
            statusText.textContent = text;
        }

        // Show message
        function showMessage(type, text) {
            const className = type === 'error' ? 'error-message' : 
                            type === 'warning' ? 'warning-message' : 'success-message';
            
            messagesDiv.innerHTML = `<div class="${className}">${escapeHtml(text)}</div>`;
        }

        // Clear messages
        function clearMessages() {
            messagesDiv.innerHTML = '';
        }

        // Clear output
        function clearOutput() {
            outputJson.value = '';
            updateStats('', 'output');
            setStatus('output', 'ready', 'Waiting for input');
        }

        // Load example
        async function loadExample() {
            try {
                const response = await fetch('./example.json');
                const example = await response.json();
                inputJson.value = JSON.stringify(example, null, 2);
                processInput();
                showMessage('success', 'Example loaded successfully');
            } catch (error) {
                showMessage('error', `Failed to load example: ${error.message}`);
            }
        }

        // Clear input
        function clearInput() {
            inputJson.value = '';
            processInput();
        }

        // Copy output
        async function copyOutput() {
            const text = outputJson.value;
            if (!text) {
                showMessage('warning', 'Nothing to copy');
                return;
            }
            
            try {
                await navigator.clipboard.writeText(text);
                showMessage('success', 'Copied to clipboard!');
            } catch (error) {
                showMessage('error', 'Failed to copy to clipboard');
            }
        }

        // Escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Update output format label
        function updateFormatLabel() {
            const format = outputFormat.value;
            outputFormatLabel.textContent = format === 'jsonld' ? '(JSON-LD)' : '(XML)';
            
            // Update context type label based on format
            const contextTypeLabel = document.getElementById('contextTypeLabel');
            const inlineOption = document.getElementById('inlineOption');
            if (format === 'xml') {
                contextTypeLabel.textContent = 'Schema Location';
                inlineOption.textContent = 'No Schema Location (Inline)';
            } else {
                contextTypeLabel.textContent = 'Context Type';
                inlineOption.textContent = 'Inline Context';
            }
        }

        // Event listeners
        inputJson.addEventListener('input', processInput);
        outputFormat.addEventListener('change', () => {
            updateFormatLabel();
            processInput();
        });
        contextType.addEventListener('change', processInput);
        loadExampleBtn.addEventListener('click', loadExample);
        clearBtn.addEventListener('click', clearInput);
        copyOutputBtn.addEventListener('click', copyOutput);

        // Initialize
        loadSchema();
        updateFormatLabel();
        updateStats('', 'input');
        updateStats('', 'output');
    </script>
</body>
</html>
